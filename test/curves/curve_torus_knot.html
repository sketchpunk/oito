<!DOCTYPE html><html><head><title></title></head><body><script type="module">

import Starter, { THREE }   from "../lib/starter.js";
import LinesMesh            from "../lib/LinesMesh.js";
import Vec3                 from "../../dist/Vec3.js";
import TorusKnot            from "../../dist/curves/TorusKnot.js";

let App, ln;

window.addEventListener( "load", _=>{
    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    App = new Starter( { webgl2:false, grid:true } );
    App.set_camera( 0, 20, 6 ).render();
    App.add( (ln = new LinesMesh( 200 )).mesh );

    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    RenderCurve.draw();
});

class RenderCurve{

    static draw(){
        ln.reset();
        const samp  = 50;           // Sample Count
        const prev  = new Vec3();   // Previous Position
        const curr  = new Vec3();   // Current Position
        const dxdy  = new Vec3();   // First Derivative ( Tangent - Look Direction )
        const dxdy2 = new Vec3();   // Second Derivative( Normal - Down Directin?? );

        let t, i;
        let p = 2;
        let q = 5;

        TorusKnot.at( prev, 0, p, q );    // Get the First Point
        for( i=1; i <= samp; i++ ){
            t = i / samp;

            TorusKnot.at( curr, t, p, q );
            TorusKnot.dxdy( dxdy, t, p, q );
            TorusKnot.dxdy2( dxdy2, t, p, q );

            ln.add( prev, curr, 0x00ffff );
            ln.add( curr, dxdy.norm().scale( 0.3 ).add( curr ), 0xffff00, null, true );
            ln.add( curr, dxdy2.norm().scale( 0.3 ).add( curr ), 0xffffff, null, true );

            prev.copy( curr );
        }
    }
    
}

</script></body></html>