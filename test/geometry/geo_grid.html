<!DOCTYPE html><html><head><title></title></head><body><script type="module">
import Starter, { THREE }   from "../lib/starter.js";
import Grid                 from "../../dist/geometry/Grid.js";

//###################################################################################

let App;

window.addEventListener( "load", _=>{
    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    App = new Starter( { webgl2:false, grid:true } );
    App.set_camera( 0, 40, 4 ).render();

    //App.add( ( pnt = new PointsMesh( 100 ) ).mesh );

    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    genGrid( false, [-1.1, 0.01, 0 ] );
    genGrid( true, [ 1.1, 0.01, 0 ] );
});

function genGrid( isAlt, offset ){
    const sGeo      = (isAlt)? Grid.getAlt( 2, 2, 5, 5, true ) : Grid.get( 2, 2, 5, 5, true );
    const bufVert   = new THREE.BufferAttribute( new Float32Array( sGeo.vertices ), 3 );
    const bufNorm   = new THREE.BufferAttribute( new Float32Array( sGeo.normals ),  3 );
    const bufUV     = new THREE.BufferAttribute( new Float32Array( sGeo.texcoord ), 2 );
    // for( let v of Vec3.bufIter( sGeo.vertices ) ) pnt.add( v );

    //----------------------------------
    // Define Geometry Object
    const bGeo      = new THREE.BufferGeometry();
    bGeo.setIndex( sGeo.indices )
    bGeo.setAttribute( "position",  bufVert );
    bGeo.setAttribute( "normal",    bufNorm );
    bGeo.setAttribute( "uv",        bufUV );

    //----------------------------------
    // Create a Renderable in Engine of choice.
    const mat  = new THREE.MeshPhongMaterial( { color:0x00ffff } );
    const mesh = new THREE.Mesh( bGeo, mat );

    mesh.add( toWireframe( bGeo ) );
    
    mesh.position.fromArray( offset );
    App.add( mesh ); 
    /**/
}

//###################################################################################

function toWireframe( geo ){
    const mat  = new THREE.LineBasicMaterial({ color:0xffffff, opacity:0.8, transparent:true });
    const wGeo = new THREE.WireframeGeometry( geo );
    return new THREE.LineSegments( wGeo, mat );
}

</script></body></html>