<!DOCTYPE html><html><head><title></title></head><body><script type="module">

import Starter, { THREE }   from "./lib/starter.js";
import Quat                 from "../dist/Quat.js";
import Maths                from "../dist/Maths.js";

let App, Cube;

window.addEventListener( "load", _=>{
    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    App = new Starter( { webgl2:false, grid:true } );
    App.onRender = onRender;
    App.set_camera( 45, 20, 6 );

    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    App.add( ( Cube = Starter.facedCube() ) );

    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    App.render();
});

function onRender( dt, et ){
    const SEC = 4;

    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    // Smoothly transition between 0 to 1 to 0 every SEC
    let t = Maths.smoothTStep( 
        Maths.bounce(
            Maths.gradient010( 
                Maths.fract( et * 1.2 / SEC ) 
            )
        )
    );

    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    // Rotate Cube

    let nx = Maths.noise( et ) * 360;          // Smooth-ish Angles  
    let nz = Maths.noise( (7.3 + et) ) * 360;
    let ry = Maths.toRad( 360 * t );           // Y Rotates from T
    
    let q  = new Quat();
    q   .fromEuler( nx, 0, nz )          // Start Rotating XZ with Noise
        .pmulAxisAngle( [0,1,0], ry )    // Apply Y Rotation
        .scaleAngle( 1.2 )               // Speed up the angle of rotation
        .norm()                          // Normalize !!!
        .toStruct( Cube.quaternion );    // Apply to THREE.JS Quat Struct
}

</script></body></html>