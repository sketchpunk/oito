<!DOCTYPE html><html><head><title></title></head><body><script type="module">

import Starter, { THREE }   from "./lib/starter.js";
import Util                 from "../dist/geometry/Util.js";

let App;

window.addEventListener( "load", _=>{
    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    App = new Starter( { webgl2:false, grid:true } );
    App.set_camera( 0, 45, 6 ).render();

    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    let a = [ 0, 0, 0 ];
    let b = [ -1, 0, 1 ];
    let c = [ 1, 0, 1 ];

    let g = Util.newGeo();
    Util.subDivideTriangle( g, a, b, c, 5 );
    Util.appendTriangleNormals( g );

    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    let mesh = tgeoMesh( g, true );
    mesh.position.y = 0.01;
    App.add( mesh );
});

function tgeoMesh( tGeo, incWireframe=false ){
    const BufAttr   = THREE.BufferAttribute;
    const bGeo      = new THREE.BufferGeometry();

    bGeo.setAttribute( "position", new BufAttr( new Float32Array( tGeo.vertices ), 3 ) );
    if( tGeo.indices && tGeo.indices.length > 0 )   bGeo.setIndex( tGeo.indices );
    if( tGeo.normals && tGeo.normals.length > 0 )   bGeo.setAttribute( "normal", new BufAttr( new Float32Array( tGeo.normals ), 3 ) );
    if( tGeo.texcoord && tGeo.texcoord.length > 0 ) bGeo.setAttribute( "uv", new BufAttr( new Float32Array( tGeo.texcoord ), 2 ) );

    const mat   = new THREE.MeshPhongMaterial( { color:0x00ffff } ); //, side:THREE.DoubleSide
    const mesh  = new THREE.Mesh( bGeo, mat );

    if( incWireframe ){
        const mat  = new THREE.LineBasicMaterial({ color:0xffffff, opacity:0.8, transparent:true });
        const wGeo = new THREE.WireframeGeometry( bGeo );
        mesh.add( new THREE.LineSegments( wGeo, mat ) );
    }

    return mesh;
}

</script></body></html>